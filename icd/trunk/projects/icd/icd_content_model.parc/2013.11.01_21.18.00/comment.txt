Added support for generation and suppression of the generation of residual classes.
